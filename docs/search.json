[
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "Paweł Wiczling, Agnieszka Kamedulska, Łukasz Kubik, 2021, “Application of Bayesian Multilevel Modeling in Quantitative Structure-Retention Relationship Studies of Heterogeneous Compounds”, Analytical Chemistry, 93 (18): 6961-6971."
  },
  {
    "objectID": "data.html",
    "href": "data.html",
    "title": "",
    "section": "",
    "text": "CodeShow All CodeHide All CodeView Source\n\n\n\n\nData\nWe used a publicly available dataset that comprises the measurements of RP-HPLC retention times collected for 1026 analytes. The retention times were measured under isocratic conditions on Eclipse Plus C18 (Agilent) stationary phase with 3.5 μm particles. The experiments were conducted using a mixture of two solvents: solvent A, which was made of 0.1% formic acid in water, and solvent B, which was made of 0.1% formic acid in acetonitrile. The column temperature was set at 35^{}C. The data were collected by Boswell et al. and were used to create a method to predict retention time by Back-Calculating the Gradient.\n\n\nCode\n# load packages\nlibrary(here)\nlibrary(ggplot2)\n\n# load data\nDS        &lt;- read.csv(here::here(\"1_data/database_stan_1026.csv\"),header = TRUE, sep = \";\", dec = \".\")\nDS_names  &lt;- read.csv(here::here(\"1_data/database_stan_1026_analyte_names.csv\"),header = TRUE, sep = \",\", dec = \".\")\n\n# divide the analytes into groups according to MM\nDS$MM_group &lt;- with(DS, ifelse(MW_ACD &lt; 200, \"1\",\n                                 ifelse(MW_ACD &lt; 300 & MW_ACD &gt;= 200, \"2\", \n                                        ifelse(MW_ACD &lt; 400 & MW_ACD &gt;= 300, \"3\", \"4\" ))))\nlab &lt;- function(x){\n  ifelse(x == 1, \"MM &lt; 200\",\n         ifelse(x == 2, \"200 \\u2264 MM &lt; 300\", \n                ifelse(x == 3, \"300 \\u2264 MM &lt; 400\", \"400 \\u2264 MM\" )))\n}\n\nnObs &lt;- length(DS$ID)\nnAnalytes &lt;- length(unique(DS$ID))\nfi &lt;- seq(0,1,0.1)\n\nggplot(data=DS, aes(x=concentration, y=logk, group=ID)) + \n  geom_line(aes(color=ID)) + \n  facet_wrap(~MM_group, ncol=2, labeller=labeller(MM_group = lab)) +\n  labs(x = expression(varphi), y = expression(Log~k[Obs])) + \n  theme_gray(base_size = 14) + theme(legend.position=\"none\") \n\n\n\n\n\nThe pH value of the mobile phase was verified experimentally for the purpose of this work. It equaled 2.66 with a standard deviation of 0.19 for the range of acetonitrile contents from 5 to 95%.\n\n\nCode\nDS_pH &lt;- read.csv(here::here(\"1_data/pH.csv\"),header = TRUE, sep = \";\", dec = \",\")\n\n\nggplot(data=DS_pH, aes(x=fi, y=pH)) + labs(x = expression(varphi), y = \"pH\") + \n  geom_point() + geom_hline(yintercept=mean(DS_pH$pH), color = \"red\") +\n  geom_hline(yintercept=mean(DS_pH$pH)-sd(DS_pH$pH), linetype=\"dashed\", color = \"red\") +\n  geom_hline(yintercept=mean(DS_pH$pH)+sd(DS_pH$pH), linetype=\"dashed\", color = \"red\") + ylim(c(2.0,3.5))\n\n\n\n\n\nThe values of molecular mass MM were added to the dataset. They were calculated using ACD/Labs program based on the provided structures of analytes. The MM ranged from 73.09 to 656.8.\n\n\nCode\nlibrary(tidyverse)\n\ndf &lt;- DS %&gt;% distinct(ID,MW_ACD) %&gt;%\n  gather(MW_ACD, key= ACD, value=\"value\") %&gt;%\n  mutate(ACD = recode(ACD, \"MW_ACD\" = \"MM\"))\n\nggplot(data= df , aes(x=ACD, y=value))+\n  geom_boxplot(aes(1))+facet_wrap(~ ACD,scales = \"free\") +\n  theme(axis.title.x=element_blank(),\n        axis.text.x=element_blank(),\n        axis.ticks.x=element_blank())\n\n\n\n\n\nInformation on the functional groups of individual compounds has also been added to the data.\n\n\nCode\nfunctional_groups         &lt;- read.csv(here::here(\"1_data/checkmol_nr_groups.csv\"),header = TRUE, sep = \",\", dec = \".\")\nfunctional_groups_names   &lt;- read.delim(here::here(\"1_data/checkmol_functional_group_names.csv\"),header = TRUE, sep = \";\", dec = \".\")\n\n\nThis information was first prepared for analysis in several steps:\n\ncombine nr of caroboxylic acid and carboxyalic acid salt functional groups\n\n\n\nCode\nfunctional_groups[,76]=functional_groups[,76]+functional_groups[,77]       \nfunctional_groups[which(functional_groups[,202]&gt;8.1),202] = 8; # heterocyclic compounds with more than 8 heterocycles are treated as if they have eigth\n\n\n\nexclude functional groups that repeat itself (some groups are nested)\n\n\n\nCode\nidx_excluded &lt;- c(1, 2, 3, 6, 27, 28, 37, 47, 48, 51, 55, 61, 62, 67, 73, 74, 75, 77, 80, 91, 99, 109, 116, 117, 121, 125, 129, 142, 153, 154, 160, 161, 168, 173, 178, 181, 182, 186, 187, 191, 196)\nfunctional_groups_names[which(functional_groups_names$ID_group %in% idx_excluded),2]\n\n\n [1] \"cation\"                      \"anion\"                      \n [3] \"carbonyl compound\"           \"thiocarbonyl compound\"      \n [5] \"hydroxy\"                     \"alcohol\"                    \n [7] \"ether\"                       \"amine\"                      \n [9] \"prim. amine\"                 \"sec. amine\"                 \n[11] \"tert. amine\"                 \"halogen deriv.\"             \n[13] \"alkyl halide\"                \"aryl halide\"                \n[15] \"organolithium compound\"      \"organomagnesium compound\"   \n[17] \"carboxylic acid deriv.\"      \"carboxylic acid salt\"       \n[19] \"carboxylic acid amide\"       \"acyl halide\"                \n[21] \"thiocarboxylic acid deriv.\"  \"orthocarboxylic acid deriv.\"\n[23] \"CO2 deriv.\"                  \"carbonic acid deriv.\"       \n[25] \"thiocarbonic acid deriv.\"    \"carbamic acid deriv\"        \n[27] \"thiocarbamic acid deriv.\"    \"diazonium salt\"             \n[29] \"sulfuric acid deriv.\"        \"sulfuric acid\"              \n[31] \"sulfuryl halide\"             \"sulfonic acid deriv.\"       \n[33] \"sulfinic acid deriv.\"        \"sulfenic acid deriv.\"       \n[35] \"thiol\"                       \"phosphoric acid deriv.\"     \n[37] \"phosphoric acid\"             \"thiophosphoric acid deriv.\" \n[39] \"thiophosphoric acid\"         \"phosphonic acid deriv.\"     \n[41] \"boronic acid deriv.\"        \n\n\nCode\nfunctional_groups &lt;- functional_groups[,-idx_excluded]\nfunctional_groups_names &lt;- functional_groups_names[-idx_excluded,]\n\n\n\nexclude functional groups not present on any analyte from the dataset\n\n\n\nCode\nidx_not_present = which(colSums(functional_groups==0) == nrow(functional_groups))\nfunctional_groups_names[which(functional_groups_names$ID_group %in% idx_not_present),2]\n\n\n [1] \"aldehyde\"                       \"thioketone\"                    \n [3] \"imine\"                          \"semicarbazone\"                 \n [5] \"oxime\"                          \"acetal\"                        \n [7] \"sec. alcohol\"                   \"enediol\"                       \n [9] \"sec. mixed amine (aryl alkyl)\"  \"aryl bromide\"                  \n[11] \"organometallic compound\"        \"carboxylic acid\"               \n[13] \"carboxylic acid ester\"          \"lactone\"                       \n[15] \"carboxylic acid prim. amide\"    \"carboxylic acid tert. amide\"   \n[17] \"lactam\"                         \"carboxylic acid azide\"         \n[19] \"carboxylic acid amidine\"        \"carboxylic acid amidrazone\"    \n[21] \"nitrile\"                        \"acyl bromide\"                  \n[23] \"acyl cyanide\"                   \"imidoyl halide\"                \n[25] \"thiolactone\"                    \"imido_thioester\"               \n[27] \"carboxylic acid anhydride\"      \"carboxylic acid unsubst. imide\"\n[29] \"carboxylic acid subst. imide\"   \"carbonic acid monoester\"       \n[31] \"carbonic acid ester halide\"     \"thiocarbonic acid diester\"     \n[33] \"thiocarbonic acid ester halide\" \"carbamic acid\"                 \n[35] \"carbamic acid halide\"           \"thiocarbamic acid ester\"       \n[37] \"isothiourea\"                    \"guanidine\"                     \n[39] \"semicarbazide\"                  \"thiosemicarbazide\"             \n[41] \"azide\"                          \"azo compound\"                  \n[43] \"isonitrile\"                     \"cyanate\"                       \n[45] \"isothiocyanate\"                 \"nitro compound\"                \n[47] \"sulfuric acid monoester\"        \"sulfuric acid diester\"         \n[49] \"sulfuric acid amide ester\"     \n\n\nCode\nfunctional_groups &lt;- functional_groups[,-idx_not_present]\nfunctional_groups_names &lt;- functional_groups_names[-idx_not_present,]\n\n\nThe functional groups present in the analyzed chemical compounds are presented below, along with their frequencies\n\n\nCode\nsumdata=data.frame(value=apply(functional_groups,2,sum))\nsumdata$key=functional_groups_names[,2]\nsumdata &lt;- sumdata[order(sumdata$value),]\nsumdata$split &lt;- rep(c(1,2),each=50)\n\nlayout(c(1,2), widths=c(1,3))\n\np1 &lt;- ggplot(data=sumdata[which(sumdata$split==1),], aes(x=reorder(key, +value), y=value, fill=key)) +\n  geom_bar(fill=\"blue\", stat=\"identity\") + \n  theme(legend.position = \"none\",\n        axis.title.x=element_blank(),\n        axis.title.y=element_blank()) + \n  coord_flip()+\n  scale_y_continuous(breaks=c(0,10))\n\np2 &lt;- ggplot(data=sumdata[which(sumdata$split==2),], aes(x=reorder(key, +value), y=value, fill=key)) +\n  geom_bar(fill=\"blue\", stat=\"identity\") + \n  theme(legend.position = \"none\",\n        axis.title.x=element_blank(),\n        axis.title.y=element_blank()) + \n  coord_flip()  \n\nlibrary(patchwork)\n\n# Custom design (# means empty area)\ndesign &lt;- \"\n  122222\n\"\n\n# Combine the plots with a custom layout\np1 + p2 +\n  plot_layout(design = design)"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Application of Bayesian Multilevel Modeling in Quantitative Structure-Retention Relationship Studies of Heterogeneous Compounds",
    "section": "",
    "text": "Quantitative structure−retention relationships (QSRRs) are used in the field of chromatography to model the relationship between an analyte structure and chromatographic retention. Such models are typically difficult to build and validate for heterogeneous compounds because of their many descriptors and relatively limited analyte-specific data.\nIn this study, a Bayesian multilevel model is proposed to characterize the isocratic retention time data collected for 1026 heterogeneous analytes. The QSRR considers the effects of the molecular mass and 100 functional groups (substituents) on analyte-specific chromatographic parameters of the Neue model (i.e., the retention factor in water, the retention factor in acetonitrile, and the curvature coefficient). A Bayesian multilevel regression model was used to smooth noisy parameter estimates with too few data and to consider the uncertainties in the model parameters.\nWe discuss the benefits of the Bayesian multilevel model: 1) to understand chromatographic data, 2) to quantify the effect of functional groups on chromatographic retention, 3) to predict analyte retention based on various types of preliminary data.\nThe uncertainty of isocratic and gradient predictions was visualized using uncertainty chromatograms and discussed in terms of usefulness in decision making. We think that this method will provide the most benefit in providing a unified scheme for analyzing large chromatographic databases and assessing the impact of functional groups and other descriptors on analyte retention."
  }
]